{"remainingRequest":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\babel-loader\\lib\\index.js!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-module-admin\\src\\views\\role\\components\\page-bind\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-module-admin\\src\\views\\role\\components\\page-bind\\index.vue","mtime":1706623138840},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\babel.config.js","mtime":1706609443763},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\babel-loader\\lib\\index.js","mtime":1706623138119},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js","mtime":1706623133543}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IHJldHVybiBfdHlwZW9mID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAobykgeyByZXR1cm4gdHlwZW9mIG87IH0gOiBmdW5jdGlvbiAobykgeyByZXR1cm4gbyAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgby5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG8gIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvOyB9LCBfdHlwZW9mKG8pOyB9CmZ1bmN0aW9uIG93bktleXMoZSwgcikgeyB2YXIgdCA9IE9iamVjdC5rZXlzKGUpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7IHIgJiYgKG8gPSBvLmZpbHRlcihmdW5jdGlvbiAocikgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCByKS5lbnVtZXJhYmxlOyB9KSksIHQucHVzaC5hcHBseSh0LCBvKTsgfSByZXR1cm4gdDsgfQpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKGUpIHsgZm9yICh2YXIgciA9IDE7IHIgPCBhcmd1bWVudHMubGVuZ3RoOyByKyspIHsgdmFyIHQgPSBudWxsICE9IGFyZ3VtZW50c1tyXSA/IGFyZ3VtZW50c1tyXSA6IHt9OyByICUgMiA/IG93bktleXMoT2JqZWN0KHQpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBfZGVmaW5lUHJvcGVydHkoZSwgciwgdFtyXSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyh0KSkgOiBvd25LZXlzKE9iamVjdCh0KSkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgciwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LCByKSk7IH0pOyB9IHJldHVybiBlOyB9CmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsga2V5ID0gX3RvUHJvcGVydHlLZXkoa2V5KTsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KHQpIHsgdmFyIGkgPSBfdG9QcmltaXRpdmUodCwgInN0cmluZyIpOyByZXR1cm4gInN5bWJvbCIgPT0gX3R5cGVvZihpKSA/IGkgOiBTdHJpbmcoaSk7IH0KZnVuY3Rpb24gX3RvUHJpbWl0aXZlKHQsIHIpIHsgaWYgKCJvYmplY3QiICE9IF90eXBlb2YodCkgfHwgIXQpIHJldHVybiB0OyB2YXIgZSA9IHRbU3ltYm9sLnRvUHJpbWl0aXZlXTsgaWYgKHZvaWQgMCAhPT0gZSkgeyB2YXIgaSA9IGUuY2FsbCh0LCByIHx8ICJkZWZhdWx0Iik7IGlmICgib2JqZWN0IiAhPSBfdHlwZW9mKGkpKSByZXR1cm4gaTsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsgfSByZXR1cm4gKCJzdHJpbmciID09PSByID8gU3RyaW5nIDogTnVtYmVyKSh0KTsgfQppbXBvcnQgeyBtYXBTdGF0ZSB9IGZyb20gJ3Z1ZXgnOwp2YXIgbW9kdWxlQXBpID0gJGFwaS5hZG1pbi5tb2R1bGU7CnZhciBfJGFwaSRhZG1pbiRyb2xlID0gJGFwaS5hZG1pbi5yb2xlLAogIF9xdWVyeUJpbmRQYWdlcyA9IF8kYXBpJGFkbWluJHJvbGUucXVlcnlCaW5kUGFnZXMsCiAgYmluZFBhZ2VzID0gXyRhcGkkYWRtaW4kcm9sZS5iaW5kUGFnZXM7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHRyZWU6IHsKICAgICAgICBkYXRhOiBbXSwKICAgICAgICBub2RlS2V5OiAnY29kZScsCiAgICAgICAgJ2V4cGFuZC1vbi1jbGljay1ub2RlJzogZmFsc2UsCiAgICAgICAgJ2RlZmF1bHQtZXhwYW5kLWFsbCc6IHRydWUsCiAgICAgICAgJ3Nob3ctY2hlY2tib3gnOiB0cnVlCiAgICAgIH0sCiAgICAgIGJpbmRQYWdlczogW10sCiAgICAgIHBhZ2VzOiBbXQogICAgfTsKICB9LAogIHByb3BzOiB7CiAgICAvL+inkuiJsklECiAgICBpZDogU3RyaW5nCiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZCh7fSwgbWFwU3RhdGUoJ2FwcC9wYWdlJywgewogICAgYWxsUGFnZXM6ICdwYWdlcycKICB9KSksCiAgbWV0aG9kczogewogICAgcmVzb2x2ZVRyZWVEYXRhOiBmdW5jdGlvbiByZXNvbHZlVHJlZURhdGEoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIC8v6I635Y+W5qih5Z2X5YiX6KGoCiAgICAgIG1vZHVsZUFwaS5zZWxlY3QoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgICB2YXIgbm9kZSA9IHsKICAgICAgICAgICAgaWQ6IG0udmFsdWUudG9Mb3dlckNhc2UoKSwKICAgICAgICAgICAgbGFiZWw6IG0ubGFiZWwsCiAgICAgICAgICAgIGNoZWNrZWQ6IGZhbHNlLAogICAgICAgICAgICBjaGlsZHJlbjogX3RoaXMuYWxsUGFnZXMuZmlsdGVyKGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHgubW9kdWxlQ29kZS50b0xvd2VyQ2FzZSgpID09PSBtLnZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbiAoeSkgewogICAgICAgICAgICAgIHZhciBidXR0b25zID0gW107CiAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHkuYnV0dG9ucykgewogICAgICAgICAgICAgICAgdmFyIGJ0biA9IHkuYnV0dG9uc1trZXldOwogICAgICAgICAgICAgICAgYnV0dG9ucy5wdXNoKHsKICAgICAgICAgICAgICAgICAgdGV4dDogYnRuLnRleHQsCiAgICAgICAgICAgICAgICAgIGNvZGU6IGJ0bi5jb2RlLAogICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uczogYnRuLnBlcm1pc3Npb25zLAogICAgICAgICAgICAgICAgICBjaGVja2VkOiBmYWxzZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhciBwYWdlID0gewogICAgICAgICAgICAgICAgY29kZTogeS5jb2RlLAogICAgICAgICAgICAgICAgbGFiZWw6IHkubmFtZSwKICAgICAgICAgICAgICAgIGJ1dHRvbnM6IGJ1dHRvbnMsCiAgICAgICAgICAgICAgICBwZXJtaXNzaW9uczogeS5wZXJtaXNzaW9ucywKICAgICAgICAgICAgICAgIGNoZWNrZWQ6IGZhbHNlCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBfdGhpcy5wYWdlcy5wdXNoKHBhZ2UpOwogICAgICAgICAgICAgIHJldHVybiBwYWdlOwogICAgICAgICAgICB9KQogICAgICAgICAgfTsKICAgICAgICAgIF90aGlzLnRyZWUuZGF0YS5wdXNoKG5vZGUpOwogICAgICAgIH0pOwogICAgICAgIF90aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICBfdGhpcy5xdWVyeUJpbmRQYWdlcygpOwogICAgICB9KTsKICAgIH0sCiAgICBxdWVyeUJpbmRQYWdlczogZnVuY3Rpb24gcXVlcnlCaW5kUGFnZXMoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB0aGlzLmJpbmRQYWdlcyA9IFtdOwogICAgICBpZiAodGhpcy5pZCkgewogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgX3F1ZXJ5QmluZFBhZ2VzKHRoaXMuaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIF90aGlzMi5iaW5kUGFnZXMgPSBkYXRhLnBhZ2VzOwogICAgICAgICAgX3RoaXMyLnJlc2V0VHJlZSgpOwogICAgICAgICAgX3RoaXMyLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHNhdmU6IGZ1bmN0aW9uIHNhdmUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwogICAgICB2YXIgbW9kZWwgPSB7CiAgICAgICAgcm9sZUlkOiB0aGlzLmlkLAogICAgICAgIHBhZ2VzOiB0aGlzLnBhZ2VzLmZpbHRlcihmdW5jdGlvbiAobSkgewogICAgICAgICAgcmV0dXJuIG0uY2hlY2tlZDsKICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKG0pIHsKICAgICAgICAgIHZhciBidXR0b25zID0gbS5idXR0b25zLmZpbHRlcihmdW5jdGlvbiAobikgewogICAgICAgICAgICByZXR1cm4gbi5jaGVja2VkOwogICAgICAgICAgfSk7CiAgICAgICAgICB2YXIgcGFnZSA9IHsKICAgICAgICAgICAgY29kZTogbS5jb2RlLAogICAgICAgICAgICBidXR0b25zOiBidXR0b25zLm1hcChmdW5jdGlvbiAoeCkgewogICAgICAgICAgICAgIHJldHVybiB4LmNvZGU7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBwZXJtaXNzaW9uczogbS5wZXJtaXNzaW9ucwogICAgICAgICAgfTsKICAgICAgICAgIGlmIChwYWdlLmJ1dHRvbnMgJiYgcGFnZS5idXR0b25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgYnV0dG9ucy5mb3JFYWNoKGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICAgICAgaWYgKHgucGVybWlzc2lvbnMgJiYgeC5wZXJtaXNzaW9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB4LnBlcm1pc3Npb25zLmZvckVhY2goZnVuY3Rpb24gKHkpIHsKICAgICAgICAgICAgICAgICAgcGFnZS5wZXJtaXNzaW9ucy5wdXNoKHkpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBwYWdlOwogICAgICAgIH0pCiAgICAgIH07CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGJpbmRQYWdlcyhtb2RlbCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMzLl9zdWNjZXNzKCfkv53lrZjmiJDlip8nKTsKICAgICAgICBfdGhpczMubG9hZGluZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICAvKirph43nva7moJEgKi9yZXNldFRyZWU6IGZ1bmN0aW9uIHJlc2V0VHJlZSgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHZhciBjaGVja2VkS2V5cyA9IFtdOwoKICAgICAgLy/lt7Lnu5HlrprnmoToj5zljZUKICAgICAgdGhpcy5wYWdlcy5mb3JFYWNoKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgdmFyIG4gPSBfdGhpczQuYmluZFBhZ2VzLmZpbmQoZnVuY3Rpb24gKHgpIHsKICAgICAgICAgIHJldHVybiB4LmNvZGUgPT09IG0uY29kZTsKICAgICAgICB9KTsKICAgICAgICBpZiAobikgewogICAgICAgICAgY2hlY2tlZEtleXMucHVzaChtLmNvZGUpOwogICAgICAgICAgbS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgIGlmIChtLmJ1dHRvbnMgJiYgbS5idXR0b25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgbS5idXR0b25zLmZvckVhY2goZnVuY3Rpb24gKHgpIHsKICAgICAgICAgICAgICB4LmNoZWNrZWQgPSBuLmJ1dHRvbnMuaW5jbHVkZXMoeC5jb2RlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG0uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgaWYgKG0uYnV0dG9ucyAmJiBtLmJ1dHRvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBtLmJ1dHRvbnMuZm9yRWFjaChmdW5jdGlvbiAoeCkgewogICAgICAgICAgICAgIHguY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXM0LiRyZWZzLnRyZWUuc2V0Q2hlY2tlZEtleXMoY2hlY2tlZEtleXMpOwogICAgICB9KTsKICAgIH0sCiAgICBvbkNoZWNrQWxsQ2hhbmdlOiBmdW5jdGlvbiBvbkNoZWNrQWxsQ2hhbmdlKGNoZWNrZWQpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CiAgICAgIHZhciBjaGVja2VkS2V5cyA9IFtdOwogICAgICBpZiAoY2hlY2tlZCkgewogICAgICAgIHRoaXMucGFnZXMuZm9yRWFjaChmdW5jdGlvbiAobSkgewogICAgICAgICAgbS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgIGNoZWNrZWRLZXlzLnB1c2gobS5jb2RlKTsKICAgICAgICAgIGlmIChtLmJ1dHRvbnMgJiYgbS5idXR0b25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgbS5idXR0b25zLmZvckVhY2goZnVuY3Rpb24gKHgpIHsKICAgICAgICAgICAgICB4LmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhZ2VzLmZvckVhY2goZnVuY3Rpb24gKG0pIHsKICAgICAgICAgIG0uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgaWYgKG0uYnV0dG9ucyAmJiBtLmJ1dHRvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBtLmJ1dHRvbnMuZm9yRWFjaChmdW5jdGlvbiAoeCkgewogICAgICAgICAgICAgIHguY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXM1LiRyZWZzLnRyZWUuc2V0Q2hlY2tlZEtleXMoY2hlY2tlZEtleXMpOwogICAgICB9KTsKICAgIH0sCiAgICBvblRyZWVDaGVjazogZnVuY3Rpb24gb25UcmVlQ2hlY2soZGF0YSwgbm9kZXMpIHsKICAgICAgdGhpcy5wYWdlcy5mb3JFYWNoKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgbS5jaGVja2VkID0gbm9kZXMuY2hlY2tlZE5vZGVzLmZpbmRJbmRleChmdW5jdGlvbiAobikgewogICAgICAgICAgcmV0dXJuIG4uY29kZSA9PT0gbS5jb2RlOwogICAgICAgIH0pID4gLTE7CiAgICAgICAgaWYgKCFtLmNoZWNrZWQgJiYgbS5idXR0b25zICYmIG0uYnV0dG9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBtLmJ1dHRvbnMuZm9yRWFjaChmdW5jdGlvbiAobSkgewogICAgICAgICAgICBtLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5yZXNvbHZlVHJlZURhdGEoKTsKICB9LAogIHdhdGNoOiB7CiAgICBpZDogZnVuY3Rpb24gaWQoKSB7CiAgICAgIC8v5bu26L+f5Yqg6L2977yM6Ziy5q2i5peg5rOV5riy5p+T5bey6YCJ5oup55qE5pWw5o2uCiAgICAgIHNldFRpbWVvdXQodGhpcy5xdWVyeUJpbmRQYWdlcywgMTAwKTsKICAgIH0KICB9Cn07"},{"version":3,"names":["mapState","moduleApi","$api","admin","module","_$api$admin$role","role","queryBindPages","bindPages","data","loading","tree","nodeKey","pages","props","id","String","computed","_objectSpread","allPages","methods","resolveTreeData","_this","select","then","forEach","m","node","value","toLowerCase","label","checked","children","filter","x","moduleCode","map","y","buttons","key","btn","push","text","code","permissions","page","name","_this2","resetTree","save","_this3","model","roleId","n","length","_success","_this4","checkedKeys","find","includes","$nextTick","$refs","setCheckedKeys","onCheckAllChange","_this5","onTreeCheck","nodes","checkedNodes","findIndex","created","watch","setTimeout"],"sources":["node_modules/netmodular-module-admin/src/views/role/components/page-bind/index.vue"],"sourcesContent":["<template>\r\n  <nm-box page :header=\"false\" footer :loading=\"loading\">\r\n    <el-alert\r\n      title=\"提示\"\r\n      type=\"warning\"\r\n      class=\"nm-m-b-10\"\r\n      description=\"Web端授权是通过绑定页面以及按钮实现的，页面以及按钮都会关联所用到接口权限，因此只要绑定了页面以及按钮就能拥有所关联的接口权限\"\r\n      show-icon\r\n    >\r\n    </el-alert>\r\n\r\n    <nm-box class=\"nm-m-b-5\" no-padding>\r\n      <el-form label-width=\"100px\">\r\n        <el-form-item class=\"nm-m-b-0\" label=\"快捷操作：\">\r\n          <el-checkbox label=\"全选\" @change=\"onCheckAllChange\"></el-checkbox>\r\n        </el-form-item>\r\n      </el-form>\r\n    </nm-box>\r\n\r\n    <el-tree ref=\"tree\" class=\"nm-admin-role-menus-tree\" v-bind=\"tree\" @check=\"onTreeCheck\">\r\n      <div class=\"nm-admin-role-menus-tree-node\" slot-scope=\"{ data }\">\r\n        <span class=\"nm-admin-role-menus-tree-node-label\">{{ data.label }}</span>\r\n        <div class=\"nm-admin-role-menus-tree-node-buttons\">\r\n          <el-checkbox v-for=\"btn in data.buttons\" :key=\"btn.code\" v-model=\"btn.checked\" :label=\"btn.text\" :disabled=\"!data.checked\"></el-checkbox>\r\n        </div>\r\n      </div>\r\n    </el-tree>\r\n\r\n    <template v-slot:footer>\r\n      <nm-button type=\"success\" text=\"保存\" @click=\"save\" />\r\n      <nm-button type=\"info\" text=\"重置\" @click=\"resetTree\" />\r\n    </template>\r\n  </nm-box>\r\n</template>\r\n<script>\r\nimport { mapState } from 'vuex'\r\nconst moduleApi = $api.admin.module\r\nconst { queryBindPages, bindPages } = $api.admin.role\r\nexport default {\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      tree: {\r\n        data: [],\r\n        nodeKey: 'code',\r\n        'expand-on-click-node': false,\r\n        'default-expand-all': true,\r\n        'show-checkbox': true\r\n      },\r\n      bindPages: [],\r\n      pages: []\r\n    }\r\n  },\r\n  props: {\r\n    //角色ID\r\n    id: String\r\n  },\r\n  computed: {\r\n    ...mapState('app/page', { allPages: 'pages' })\r\n  },\r\n  methods: {\r\n    resolveTreeData() {\r\n      this.loading = true\r\n      //获取模块列表\r\n      moduleApi.select().then(data => {\r\n        data.forEach(m => {\r\n          let node = {\r\n            id: m.value.toLowerCase(),\r\n            label: m.label,\r\n            checked: false,\r\n            children: this.allPages\r\n              .filter(x => x.moduleCode.toLowerCase() === m.value.toLowerCase())\r\n              .map(y => {\r\n                let buttons = []\r\n                for (let key in y.buttons) {\r\n                  let btn = y.buttons[key]\r\n                  buttons.push({\r\n                    text: btn.text,\r\n                    code: btn.code,\r\n                    permissions: btn.permissions,\r\n                    checked: false\r\n                  })\r\n                }\r\n                let page = {\r\n                  code: y.code,\r\n                  label: y.name,\r\n                  buttons: buttons,\r\n                  permissions: y.permissions,\r\n                  checked: false\r\n                }\r\n\r\n                this.pages.push(page)\r\n                return page\r\n              })\r\n          }\r\n          this.tree.data.push(node)\r\n        })\r\n        this.loading = false\r\n\r\n        this.queryBindPages()\r\n      })\r\n    },\r\n    queryBindPages() {\r\n      this.bindPages = []\r\n      if (this.id) {\r\n        this.loading = true\r\n        queryBindPages(this.id).then(data => {\r\n          this.bindPages = data.pages\r\n          this.resetTree()\r\n          this.loading = false\r\n        })\r\n      }\r\n    },\r\n    save() {\r\n      let model = {\r\n        roleId: this.id,\r\n        pages: this.pages\r\n          .filter(m => m.checked)\r\n          .map(m => {\r\n            let buttons = m.buttons.filter(n => n.checked)\r\n            let page = {\r\n              code: m.code,\r\n              buttons: buttons.map(x => x.code),\r\n              permissions: m.permissions\r\n            }\r\n\r\n            if (page.buttons && page.buttons.length > 0) {\r\n              buttons.forEach(x => {\r\n                if (x.permissions && x.permissions.length > 0) {\r\n                  x.permissions.forEach(y => {\r\n                    page.permissions.push(y)\r\n                  })\r\n                }\r\n              })\r\n            }\r\n\r\n            return page\r\n          })\r\n      }\r\n      this.loading = true\r\n      bindPages(model).then(() => {\r\n        this._success('保存成功')\r\n        this.loading = false\r\n      })\r\n    },\r\n    /**重置树 */\r\n    resetTree() {\r\n      let checkedKeys = []\r\n\r\n      //已绑定的菜单\r\n      this.pages.forEach(m => {\r\n        let n = this.bindPages.find(x => x.code === m.code)\r\n        if (n) {\r\n          checkedKeys.push(m.code)\r\n          m.checked = true\r\n          if (m.buttons && m.buttons.length > 0) {\r\n            m.buttons.forEach(x => {\r\n              x.checked = n.buttons.includes(x.code)\r\n            })\r\n          }\r\n        } else {\r\n          m.checked = false\r\n          if (m.buttons && m.buttons.length > 0) {\r\n            m.buttons.forEach(x => {\r\n              x.checked = false\r\n            })\r\n          }\r\n        }\r\n      })\r\n      this.$nextTick(() => {\r\n        this.$refs.tree.setCheckedKeys(checkedKeys)\r\n      })\r\n    },\r\n    onCheckAllChange(checked) {\r\n      let checkedKeys = []\r\n      if (checked) {\r\n        this.pages.forEach(m => {\r\n          m.checked = true\r\n          checkedKeys.push(m.code)\r\n          if (m.buttons && m.buttons.length > 0) {\r\n            m.buttons.forEach(x => {\r\n              x.checked = true\r\n            })\r\n          }\r\n        })\r\n      } else {\r\n        this.pages.forEach(m => {\r\n          m.checked = false\r\n          if (m.buttons && m.buttons.length > 0) {\r\n            m.buttons.forEach(x => {\r\n              x.checked = false\r\n            })\r\n          }\r\n        })\r\n      }\r\n      this.$nextTick(() => {\r\n        this.$refs.tree.setCheckedKeys(checkedKeys)\r\n      })\r\n    },\r\n    onTreeCheck(data, nodes) {\r\n      this.pages.forEach(m => {\r\n        m.checked = nodes.checkedNodes.findIndex(n => n.code === m.code) > -1\r\n        if (!m.checked && m.buttons && m.buttons.length > 0) {\r\n          m.buttons.forEach(m => {\r\n            m.checked = false\r\n          })\r\n        }\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.resolveTreeData()\r\n  },\r\n  watch: {\r\n    id() {\r\n      //延迟加载，防止无法渲染已选择的数据\r\n      setTimeout(this.queryBindPages, 100)\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"mappings":"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"}]}