{"remainingRequest":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\babel-loader\\lib\\index.js!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-module-admin\\src\\views\\role\\components\\platform-bind\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-module-admin\\src\\views\\role\\components\\platform-bind\\index.vue","mtime":1706623138842},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\babel.config.js","mtime":1706609443763},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\babel-loader\\lib\\index.js","mtime":1706623138119},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js","mtime":1706623133543}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgbWl4aW5zIH0gZnJvbSAnbmV0bW9kdWxhci11aSc7CnZhciBhcGkgPSAkYXBpLmFkbWluLnBlcm1pc3Npb247CnZhciBfJGFwaSRhZG1pbiRyb2xlID0gJGFwaS5hZG1pbi5yb2xlLAogIF9xdWVyeUJpbmRQbGF0Zm9ybVBlcm1pc3Npb25zID0gXyRhcGkkYWRtaW4kcm9sZS5xdWVyeUJpbmRQbGF0Zm9ybVBlcm1pc3Npb25zLAogIGJpbmRQbGF0Zm9ybVBlcm1pc3Npb25zID0gXyRhcGkkYWRtaW4kcm9sZS5iaW5kUGxhdGZvcm1QZXJtaXNzaW9uczsKZXhwb3J0IGRlZmF1bHQgewogIG1peGluczogW21peGlucy52aXNpYmxlXSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdHJlZTogewogICAgICAgIGRhdGE6IFtdLAogICAgICAgIG5vZGVLZXk6ICdpZCcsCiAgICAgICAgZGVmYXVsdEV4cGFuZEFsbDogdHJ1ZSwKICAgICAgICBzaG93Q2hlY2tib3g6IHRydWUKICAgICAgfSwKICAgICAgcGxhdGZvcm06IDEsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBwZXJtaXNzaW9uczogW10KICAgIH07CiAgfSwKICBwcm9wczogewogICAgaWQ6IFN0cmluZwogIH0sCiAgbWV0aG9kczogewogICAgcXVlcnlQZXJtaXNzaW9uVHJlZTogZnVuY3Rpb24gcXVlcnlQZXJtaXNzaW9uVHJlZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgYXBpLnRyZWUoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgX3RoaXMudHJlZS5kYXRhID0gW2RhdGFdOwogICAgICAgIF90aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgcXVlcnlCaW5kUGxhdGZvcm1QZXJtaXNzaW9uczogZnVuY3Rpb24gcXVlcnlCaW5kUGxhdGZvcm1QZXJtaXNzaW9ucygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIF9xdWVyeUJpbmRQbGF0Zm9ybVBlcm1pc3Npb25zKHsKICAgICAgICByb2xlSWQ6IHRoaXMuaWQsCiAgICAgICAgcGxhdGZvcm06IHRoaXMucGxhdGZvcm0KICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIF90aGlzMi5wZXJtaXNzaW9ucyA9IGRhdGE7CiAgICAgICAgX3RoaXMyLnJlc2V0KCk7CiAgICAgICAgX3RoaXMyLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgc2F2ZTogZnVuY3Rpb24gc2F2ZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHZhciBwZXJtaXNzaW9ucyA9IHRoaXMuJHJlZnMudHJlZS5nZXRDaGVja2VkTm9kZXMoKS5maWx0ZXIoZnVuY3Rpb24gKG0pIHsKICAgICAgICByZXR1cm4gbS5pdGVtLmlzUGVybWlzc2lvbjsKICAgICAgfSkubWFwKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgcmV0dXJuIG0uaXRlbS5jb2RlOwogICAgICB9KTsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgYmluZFBsYXRmb3JtUGVybWlzc2lvbnMoewogICAgICAgIHJvbGVJZDogdGhpcy5pZCwKICAgICAgICBwbGF0Zm9ybTogdGhpcy5wbGF0Zm9ybSwKICAgICAgICBwZXJtaXNzaW9uczogcGVybWlzc2lvbnMKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMzLl9zdWNjZXNzKCfkv53lrZjmiJDlip8nKTsKICAgICAgICBfdGhpczMucGVybWlzc2lvbnMgPSBwZXJtaXNzaW9uczsKICAgICAgICBfdGhpczMubG9hZGluZyA9IGZhbHNlOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgcmVzZXQ6IGZ1bmN0aW9uIHJlc2V0KCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNC4kcmVmcy50cmVlLnNldENoZWNrZWRLZXlzKF90aGlzNC5wZXJtaXNzaW9ucyk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMucXVlcnlQZXJtaXNzaW9uVHJlZSgpOwogICAgdGhpcy5xdWVyeUJpbmRQbGF0Zm9ybVBlcm1pc3Npb25zKCk7CiAgfSwKICB3YXRjaDogewogICAgaWQ6IGZ1bmN0aW9uIGlkKCkgewogICAgICB0aGlzLnBsYXRmb3JtID0gMTsKICAgICAgdGhpcy5xdWVyeUJpbmRQbGF0Zm9ybVBlcm1pc3Npb25zKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["mixins","api","$api","admin","permission","_$api$admin$role","role","queryBindPlatformPermissions","bindPlatformPermissions","visible","data","tree","nodeKey","defaultExpandAll","showCheckbox","platform","loading","permissions","props","id","String","methods","queryPermissionTree","_this","then","catch","_this2","roleId","reset","save","_this3","$refs","getCheckedNodes","filter","m","item","isPermission","map","code","_success","_this4","$nextTick","setCheckedKeys","created","watch"],"sources":["node_modules/netmodular-module-admin/src/views/role/components/platform-bind/index.vue"],"sourcesContent":["<template>\r\n  <nm-box page :header=\"false\" footer :loading=\"loading\">\r\n    <el-alert title=\"提示\" type=\"warning\" class=\"nm-m-10\" description=\"平台授权是给Web平台以外的平台绑定权限使用的，比如安卓、IOS、小程序等等\" show-icon> </el-alert>\r\n    <el-form label-width=\"100px\">\r\n      <el-form-item style=\"width:500px;margin:15px 0;\" label=\"选择平台：\">\r\n        <nm-platform-select v-model=\"platform\" no-web @change=\"queryBindPlatformPermissions\" :clearable=\"false\" />\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-tree ref=\"tree\" v-bind=\"tree\">\r\n      <span slot-scope=\"{ data }\">\r\n        <nm-icon name=\"attachment\" />\r\n        <span class=\"nm-m-l-5\"\r\n          >{{ data.label\r\n          }}<label v-if=\"data.item.isPermission\" class=\"nm-p-l-5 nm-text-info nm-size-14\" style=\"font-style: italic;\"\r\n            >(<label>{{ data.item.code }}</label\r\n            >)</label\r\n          ></span\r\n        >\r\n      </span>\r\n    </el-tree>\r\n    <template v-slot:footer>\r\n      <nm-button type=\"success\" text=\"保存\" @click=\"save\" />\r\n      <nm-button type=\"info\" text=\"重置\" @click=\"reset\" />\r\n    </template>\r\n  </nm-box>\r\n</template>\r\n<script>\r\nimport { mixins } from 'netmodular-ui'\r\nconst api = $api.admin.permission\r\nconst { queryBindPlatformPermissions, bindPlatformPermissions } = $api.admin.role\r\nexport default {\r\n  mixins: [mixins.visible],\r\n  data() {\r\n    return {\r\n      tree: {\r\n        data: [],\r\n        nodeKey: 'id',\r\n        defaultExpandAll: true,\r\n        showCheckbox: true\r\n      },\r\n      platform: 1,\r\n      loading: false,\r\n      permissions: []\r\n    }\r\n  },\r\n  props: {\r\n    id: String\r\n  },\r\n  methods: {\r\n    queryPermissionTree() {\r\n      this.loading = true\r\n      api\r\n        .tree()\r\n        .then(data => {\r\n          this.tree.data = [data]\r\n          this.loading = false\r\n        })\r\n        .catch(() => {\r\n          this.loading = false\r\n        })\r\n    },\r\n    queryBindPlatformPermissions() {\r\n      this.loading = true\r\n      queryBindPlatformPermissions({ roleId: this.id, platform: this.platform }).then(data => {\r\n        this.permissions = data\r\n        this.reset()\r\n        this.loading = false\r\n      })\r\n    },\r\n    save() {\r\n      let permissions = this.$refs.tree\r\n        .getCheckedNodes()\r\n        .filter(m => m.item.isPermission)\r\n        .map(m => {\r\n          return m.item.code\r\n        })\r\n      this.loading = true\r\n      bindPlatformPermissions({ roleId: this.id, platform: this.platform, permissions })\r\n        .then(() => {\r\n          this._success('保存成功')\r\n          this.permissions = permissions\r\n          this.loading = false\r\n        })\r\n        .catch(() => {\r\n          this.loading = false\r\n        })\r\n    },\r\n    reset() {\r\n      this.$nextTick(() => {\r\n        this.$refs.tree.setCheckedKeys(this.permissions)\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.queryPermissionTree()\r\n    this.queryBindPlatformPermissions()\r\n  },\r\n  watch: {\r\n    id() {\r\n      this.platform = 1\r\n      this.queryBindPlatformPermissions()\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"mappings":"AA2BA,SAAAA,MAAA;AACA,IAAAC,GAAA,GAAAC,IAAA,CAAAC,KAAA,CAAAC,UAAA;AACA,IAAAC,gBAAA,GAAAH,IAAA,CAAAC,KAAA,CAAAG,IAAA;EAAAC,6BAAA,GAAAF,gBAAA,CAAAE,4BAAA;EAAAC,uBAAA,GAAAH,gBAAA,CAAAG,uBAAA;AACA;EACAR,MAAA,GAAAA,MAAA,CAAAS,OAAA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,IAAA;QACAD,IAAA;QACAE,OAAA;QACAC,gBAAA;QACAC,YAAA;MACA;MACAC,QAAA;MACAC,OAAA;MACAC,WAAA;IACA;EACA;EACAC,KAAA;IACAC,EAAA,EAAAC;EACA;EACAC,OAAA;IACAC,mBAAA,WAAAA,oBAAA;MAAA,IAAAC,KAAA;MACA,KAAAP,OAAA;MACAf,GAAA,CACAU,IAAA,GACAa,IAAA,WAAAd,IAAA;QACAa,KAAA,CAAAZ,IAAA,CAAAD,IAAA,IAAAA,IAAA;QACAa,KAAA,CAAAP,OAAA;MACA,GACAS,KAAA;QACAF,KAAA,CAAAP,OAAA;MACA;IACA;IACAT,4BAAA,WAAAA,6BAAA;MAAA,IAAAmB,MAAA;MACA,KAAAV,OAAA;MACAT,6BAAA;QAAAoB,MAAA,OAAAR,EAAA;QAAAJ,QAAA,OAAAA;MAAA,GAAAS,IAAA,WAAAd,IAAA;QACAgB,MAAA,CAAAT,WAAA,GAAAP,IAAA;QACAgB,MAAA,CAAAE,KAAA;QACAF,MAAA,CAAAV,OAAA;MACA;IACA;IACAa,IAAA,WAAAA,KAAA;MAAA,IAAAC,MAAA;MACA,IAAAb,WAAA,QAAAc,KAAA,CAAApB,IAAA,CACAqB,eAAA,GACAC,MAAA,WAAAC,CAAA;QAAA,OAAAA,CAAA,CAAAC,IAAA,CAAAC,YAAA;MAAA,GACAC,GAAA,WAAAH,CAAA;QACA,OAAAA,CAAA,CAAAC,IAAA,CAAAG,IAAA;MACA;MACA,KAAAtB,OAAA;MACAR,uBAAA;QAAAmB,MAAA,OAAAR,EAAA;QAAAJ,QAAA,OAAAA,QAAA;QAAAE,WAAA,EAAAA;MAAA,GACAO,IAAA;QACAM,MAAA,CAAAS,QAAA;QACAT,MAAA,CAAAb,WAAA,GAAAA,WAAA;QACAa,MAAA,CAAAd,OAAA;MACA,GACAS,KAAA;QACAK,MAAA,CAAAd,OAAA;MACA;IACA;IACAY,KAAA,WAAAA,MAAA;MAAA,IAAAY,MAAA;MACA,KAAAC,SAAA;QACAD,MAAA,CAAAT,KAAA,CAAApB,IAAA,CAAA+B,cAAA,CAAAF,MAAA,CAAAvB,WAAA;MACA;IACA;EACA;EACA0B,OAAA,WAAAA,QAAA;IACA,KAAArB,mBAAA;IACA,KAAAf,4BAAA;EACA;EACAqC,KAAA;IACAzB,EAAA,WAAAA,GAAA;MACA,KAAAJ,QAAA;MACA,KAAAR,4BAAA;IACA;EACA;AACA"}]}