{"remainingRequest":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-module-admin\\src\\views\\role\\components\\menu-bind\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-module-admin\\src\\views\\role\\components\\menu-bind\\index.vue","mtime":1706623138837},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\babel-loader\\lib\\index.js","mtime":1706623138119},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js","mtime":1706623133543}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpjb25zdCBtZW51QXBpID0gJGFwaS5hZG1pbi5tZW51DQpjb25zdCB7IHF1ZXJ5QmluZE1lbnVzLCBiaW5kTWVudXMgfSA9ICRhcGkuYWRtaW4ucm9sZQ0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBsb2FkaW5nOiBmYWxzZSwNCiAgICAgIG1lbnVUcmVlOiB7DQogICAgICAgIGRhdGE6IFtdLA0KICAgICAgICBub2RlS2V5OiAnaWQnLA0KICAgICAgICAnZXhwYW5kLW9uLWNsaWNrLW5vZGUnOiBmYWxzZSwNCiAgICAgICAgJ2RlZmF1bHQtZXhwYW5kLWFsbCc6IHRydWUsDQogICAgICAgICdzaG93LWNoZWNrYm94JzogdHJ1ZQ0KICAgICAgfSwNCiAgICAgIG1lbnVzOiBbXQ0KICAgIH0NCiAgfSwNCiAgcHJvcHM6IHsNCiAgICAvL+inkuiJsklEDQogICAgaWQ6IFN0cmluZw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgcXVlcnlNZW51VHJlZSgpIHsNCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUNCiAgICAgIG1lbnVBcGkuZ2V0VHJlZSgpLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIHRoaXMubWVudVRyZWUuZGF0YSA9IFtkYXRhXQ0KICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHF1ZXJ5QmluZE1lbnVzKCkgew0KICAgICAgdGhpcy5tZW51cyA9IFtdDQogICAgICBpZiAodGhpcy5pZCkgew0KICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlDQogICAgICAgIHF1ZXJ5QmluZE1lbnVzKHRoaXMuaWQpLnRoZW4oZGF0YSA9PiB7DQogICAgICAgICAgdGhpcy5tZW51cyA9IGRhdGENCiAgICAgICAgICB0aGlzLnJlc2V0KCkNCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICB9KQ0KICAgICAgfQ0KICAgIH0sDQogICAgc2F2ZSgpIHsNCiAgICAgIGxldCBtb2RlbCA9IHsNCiAgICAgICAgcm9sZUlkOiB0aGlzLmlkLA0KICAgICAgICBtZW51czogdGhpcy4kcmVmcy50cmVlLmdldENoZWNrZWRLZXlzKCkuY29uY2F0KHRoaXMuJHJlZnMudHJlZS5nZXRIYWxmQ2hlY2tlZEtleXMoKSkNCiAgICAgIH0NCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUNCiAgICAgIGJpbmRNZW51cyhtb2RlbCkudGhlbigoKSA9PiB7DQogICAgICAgIHRoaXMuX3N1Y2Nlc3MoJ+S/neWtmOaIkOWKnycpDQogICAgICAgIHRoaXMubWVudXMgPSBtb2RlbC5tZW51cw0KICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHJlc2V0KCkgew0KICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICB0aGlzLiRyZWZzLnRyZWUuc2V0Q2hlY2tlZEtleXModGhpcy5tZW51cykNCiAgICAgIH0pDQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMucXVlcnlNZW51VHJlZSgpDQogICAgdGhpcy5xdWVyeUJpbmRNZW51cygpDQogIH0sDQogIHdhdGNoOiB7DQogICAgaWQoKSB7DQogICAgICAvL+W7tui/n+WKoOi9ve+8jOmYsuatouaXoOazlea4suafk+W3sumAieaLqeeahOaVsOaNrg0KICAgICAgc2V0VGltZW91dCh0aGlzLnF1ZXJ5QmluZE1lbnVzLCAxMDApDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/netmodular-module-admin/src/views/role/components/menu-bind","sourcesContent":["<template>\r\n  <nm-box page :header=\"false\" footer :loading=\"loading\">\r\n    <el-alert title=\"提示\" type=\"warning\" class=\"nm-m-b-10\" description=\"路由菜单基于页面配置，同一个页面可以配置任意个菜单\" show-icon> </el-alert>\r\n    <el-tree ref=\"tree\" class=\"nm-admin-role-menus-tree\" v-bind=\"menuTree\">\r\n      <div class=\"nm-admin-role-menus-tree-node\" slot-scope=\"{ data }\">\r\n        <span class=\"nm-admin-role-menus-tree-node-label\"><nm-icon :name=\"data.item.icon || 'attachment'\" /> {{ data.label }}</span>\r\n      </div>\r\n    </el-tree>\r\n\r\n    <template v-slot:footer>\r\n      <nm-button type=\"success\" text=\"保存\" @click=\"save\" />\r\n      <nm-button type=\"info\" text=\"重置\" @click=\"reset\" />\r\n    </template>\r\n  </nm-box>\r\n</template>\r\n<script>\r\nconst menuApi = $api.admin.menu\r\nconst { queryBindMenus, bindMenus } = $api.admin.role\r\nexport default {\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      menuTree: {\r\n        data: [],\r\n        nodeKey: 'id',\r\n        'expand-on-click-node': false,\r\n        'default-expand-all': true,\r\n        'show-checkbox': true\r\n      },\r\n      menus: []\r\n    }\r\n  },\r\n  props: {\r\n    //角色ID\r\n    id: String\r\n  },\r\n  methods: {\r\n    queryMenuTree() {\r\n      this.loading = true\r\n      menuApi.getTree().then(data => {\r\n        this.menuTree.data = [data]\r\n        this.loading = false\r\n      })\r\n    },\r\n    queryBindMenus() {\r\n      this.menus = []\r\n      if (this.id) {\r\n        this.loading = true\r\n        queryBindMenus(this.id).then(data => {\r\n          this.menus = data\r\n          this.reset()\r\n          this.loading = false\r\n        })\r\n      }\r\n    },\r\n    save() {\r\n      let model = {\r\n        roleId: this.id,\r\n        menus: this.$refs.tree.getCheckedKeys().concat(this.$refs.tree.getHalfCheckedKeys())\r\n      }\r\n      this.loading = true\r\n      bindMenus(model).then(() => {\r\n        this._success('保存成功')\r\n        this.menus = model.menus\r\n        this.loading = false\r\n      })\r\n    },\r\n    reset() {\r\n      this.$nextTick(() => {\r\n        this.$refs.tree.setCheckedKeys(this.menus)\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.queryMenuTree()\r\n    this.queryBindMenus()\r\n  },\r\n  watch: {\r\n    id() {\r\n      //延迟加载，防止无法渲染已选择的数据\r\n      setTimeout(this.queryBindMenus, 100)\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}