{"remainingRequest":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-ui\\packages\\components\\login-neon\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-ui\\packages\\components\\login-neon\\index.vue","mtime":1706623144444},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\babel-loader\\lib\\index.js","mtime":1706623138119},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js","mtime":1706623133543}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBtYXBTdGF0ZSwgbWFwR2V0dGVycywgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdMb2dpbk5lb24nLA0KICBkYXRhKCkgew0KICAgIGNvbnN0IF90aGlzID0gdGhpcw0KICAgIHJldHVybiB7DQogICAgICB2ZXJpZnlDb2RlVXJsOiAnJywNCiAgICAgIGZvcm06IHsNCiAgICAgICAgdXNlck5hbWU6ICcnLA0KICAgICAgICBwYXNzd29yZDogJycsDQogICAgICAgIGFjY291bnRUeXBlOiAwLA0KICAgICAgICB2ZXJpZnlDb2RlOiB7DQogICAgICAgICAgaWQ6ICcnLA0KICAgICAgICAgIGNvZGU6ICcnDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICBydWxlczogew0KICAgICAgICB1c2VyTmFtZTogWw0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeeUqOaIt+WQjScsDQogICAgICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJw0KICAgICAgICAgIH0NCiAgICAgICAgXSwNCiAgICAgICAgcGFzc3dvcmQ6IFsNCiAgICAgICAgICB7DQogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXlr4bnoIEnLA0KICAgICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScNCiAgICAgICAgICB9DQogICAgICAgIF0sDQogICAgICAgIGNvZGU6IFsNCiAgICAgICAgICB7DQogICAgICAgICAgICB2YWxpZGF0b3IocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSB7DQogICAgICAgICAgICAgIGlmIChfdGhpcy5sb2dpblZlcmlmeUNvZGUgJiYgdmFsdWUgPT09ICcnKSB7DQogICAgICAgICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfor7fovpPlhaXpqozor4HnoIEnKSkNCiAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBjYWxsYmFjaygpDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicNCiAgICAgICAgICB9DQogICAgICAgIF0NCiAgICAgIH0sDQogICAgICBsb2FkaW5nOiBmYWxzZQ0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICAuLi5tYXBHZXR0ZXJzKCdhcHAvY29uZmlnJywgWydsb2dvVXJsJ10pLA0KICAgIC4uLm1hcFN0YXRlKCdhcHAvY29uZmlnJywgew0KICAgICAgdGl0bGU6IHMgPT4gcy5zeXN0ZW0udGl0bGUsDQogICAgICBjb3B5cmlnaHQ6IHMgPT4gcy5zeXN0ZW0uY29weXJpZ2h0LA0KICAgICAgbG9naW5PcHRpb25zOiBzID0+IHMuY29tcG9uZW50LmxvZ2luDQogICAgfSksDQogICAgLi4ubWFwU3RhdGUoJ2FwcC9zeXN0ZW0nLCB7DQogICAgICBnZXRWZXJpZnlDb2RlOiBzID0+IHMuYWN0aW9ucy5nZXRWZXJpZnlDb2RlDQogICAgfSkNCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICBpZiAodGhpcy5sb2dpbk9wdGlvbnMudmVyaWZ5Q29kZSkgew0KICAgICAgdGhpcy5yZWZyZXNoVmllcmlmeUNvZGUoKQ0KICAgIH0NCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZSA9PiB7DQogICAgICBpZiAoZS5rZXlDb2RlID09PSAxMykgew0KICAgICAgICB0aGlzLnRyeUxvZ2luKCkNCiAgICAgIH0NCiAgICB9KQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLi4ubWFwQWN0aW9ucygnYXBwL3N5c3RlbScsIFsnbG9naW4nXSksDQogICAgLy8g5Yi35paw6aqM6K+B56CBDQogICAgYXN5bmMgcmVmcmVzaFZpZXJpZnlDb2RlKCkgew0KICAgICAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmdldFZlcmlmeUNvZGUoKQ0KICAgICAgdGhpcy52ZXJpZnlDb2RlVXJsID0gZGF0YS5iYXNlNjRTdHJpbmcNCiAgICAgIHRoaXMuZm9ybS52ZXJpZnlDb2RlLmlkID0gZGF0YS5pZA0KICAgIH0sDQogICAgLy8g55m75b2VDQogICAgdHJ5TG9naW4oKSB7DQogICAgICB0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlDQoNCiAgICAgICAgICB0aGlzLmxvZ2luKHRoaXMuZm9ybSkNCiAgICAgICAgICAgIC50aGVuKGRhdGEgPT4gew0KICAgICAgICAgICAgICAvLyDliJ3lp4vljJbku6TniYwNCiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdhcHAvdG9rZW4vaW5pdCcsIGRhdGEpDQoNCiAgICAgICAgICAgICAgLy8g6Lez6L2sDQogICAgICAgICAgICAgIGxldCByZWRpcmVjdCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnJlZGlyZWN0DQogICAgICAgICAgICAgIGlmICghcmVkaXJlY3QgfHwgcmVkaXJlY3QgPT09ICcnKSB7DQogICAgICAgICAgICAgICAgcmVkaXJlY3QgPSAnLycNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsNCiAgICAgICAgICAgICAgICBwYXRoOiByZWRpcmVjdA0KICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UNCiAgICAgICAgICAgIH0pDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfQ0KICB9LA0KICB3YXRjaDogew0KICAgIGxvZ2luT3B0aW9uczogew0KICAgICAgaW1tZWRpYXRlOiB0cnVlLA0KICAgICAgaGFuZGxlcih2YWwpIHsNCiAgICAgICAgdGhpcy5mb3JtLmFjY291bnRUeXBlID0gdmFsLmRlZmF1bHRBY2NvdW50VHlwZQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAuDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/netmodular-ui/packages/components/login-neon","sourcesContent":["<template>\r\n  <div class=\"nm-login-neon\">\r\n    <div class=\"login-header\">\r\n      <div class=\"login-logo\">\r\n        <img :src=\"logoUrl\" />\r\n      </div>\r\n      <div class=\"login-title\">{{ title }}</div>\r\n    </div>\r\n    <div class=\"login-form\">\r\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\">\r\n        <el-form-item v-if=\"loginOptions.accountTypes\" prop=\"accountType\">\r\n          <el-select v-model=\"form.accountType\" placeholder=\"账户类型\">\r\n            <template v-slot:prefix>\r\n              <nm-icon name=\"project\" />\r\n            </template>\r\n            <el-option v-for=\"item in loginOptions.accountTypes\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item prop=\"userName\">\r\n          <el-input v-model=\"form.userName\" placeholder=\"用户名\">\r\n            <template v-slot:prefix>\r\n              <nm-icon name=\"user\" />\r\n            </template>\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"password\">\r\n          <el-input type=\"password\" v-model=\"form.password\" autocomplete=\"off\" placeholder=\"密码\">\r\n            <template v-slot:prefix>\r\n              <nm-icon name=\"password\" />\r\n            </template>\r\n          </el-input>\r\n        </el-form-item>\r\n        <div v-if=\"loginOptions.verifyCode\" class=\"verifycode\">\r\n          <div class=\"verifycode-input\">\r\n            <el-form-item prop=\"verifyCode.code\">\r\n              <el-input v-model=\"form.verifyCode.code\" autocomplete=\"off\" placeholder=\"验证码\">\r\n                <template v-slot:prefix>\r\n                  <nm-icon name=\"verifycode\"></nm-icon>\r\n                </template>\r\n              </el-input>\r\n            </el-form-item>\r\n          </div>\r\n          <div class=\"verifycode-img\">\r\n            <img title=\"点击刷新\" :src=\"verifyCodeUrl\" @click=\"refreshVierifyCode\" />\r\n          </div>\r\n        </div>\r\n        <el-form-item style=\"text-align:right;\">\r\n          <nm-button icon=\"login\" :loading=\"loading\" class=\"login-btn\" @click=\"tryLogin\">登录</nm-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n    <div class=\"copyright\">{{ copyright }}</div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapState, mapGetters, mapActions } from 'vuex'\r\nexport default {\r\n  name: 'LoginNeon',\r\n  data() {\r\n    const _this = this\r\n    return {\r\n      verifyCodeUrl: '',\r\n      form: {\r\n        userName: '',\r\n        password: '',\r\n        accountType: 0,\r\n        verifyCode: {\r\n          id: '',\r\n          code: ''\r\n        }\r\n      },\r\n      rules: {\r\n        userName: [\r\n          {\r\n            required: true,\r\n            message: '请输入用户名',\r\n            trigger: 'change'\r\n          }\r\n        ],\r\n        password: [\r\n          {\r\n            required: true,\r\n            message: '请输入密码',\r\n            trigger: 'change'\r\n          }\r\n        ],\r\n        code: [\r\n          {\r\n            validator(rule, value, callback) {\r\n              if (_this.loginVerifyCode && value === '') {\r\n                callback(new Error('请输入验证码'))\r\n              } else {\r\n                callback()\r\n              }\r\n            },\r\n            trigger: 'blur'\r\n          }\r\n        ]\r\n      },\r\n      loading: false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters('app/config', ['logoUrl']),\r\n    ...mapState('app/config', {\r\n      title: s => s.system.title,\r\n      copyright: s => s.system.copyright,\r\n      loginOptions: s => s.component.login\r\n    }),\r\n    ...mapState('app/system', {\r\n      getVerifyCode: s => s.actions.getVerifyCode\r\n    })\r\n  },\r\n  mounted() {\r\n    if (this.loginOptions.verifyCode) {\r\n      this.refreshVierifyCode()\r\n    }\r\n    document.addEventListener('keydown', e => {\r\n      if (e.keyCode === 13) {\r\n        this.tryLogin()\r\n      }\r\n    })\r\n  },\r\n  methods: {\r\n    ...mapActions('app/system', ['login']),\r\n    // 刷新验证码\r\n    async refreshVierifyCode() {\r\n      let data = await this.getVerifyCode()\r\n      this.verifyCodeUrl = data.base64String\r\n      this.form.verifyCode.id = data.id\r\n    },\r\n    // 登录\r\n    tryLogin() {\r\n      this.$refs.form.validate(async valid => {\r\n        if (valid) {\r\n          this.loading = true\r\n\r\n          this.login(this.form)\r\n            .then(data => {\r\n              // 初始化令牌\r\n              this.$store.commit('app/token/init', data)\r\n\r\n              // 跳转\r\n              let redirect = this.$route.query.redirect\r\n              if (!redirect || redirect === '') {\r\n                redirect = '/'\r\n              }\r\n\r\n              this.$router.push({\r\n                path: redirect\r\n              })\r\n            })\r\n            .finally(() => {\r\n              this.loading = false\r\n            })\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  },\r\n  watch: {\r\n    loginOptions: {\r\n      immediate: true,\r\n      handler(val) {\r\n        this.form.accountType = val.defaultAccountType\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}