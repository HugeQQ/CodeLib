{"remainingRequest":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\src\\views\\modelProperty\\components\\import\\index.vue?vue&type=style&index=0&id=32d57fa6&lang=scss","dependencies":[{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\src\\views\\modelProperty\\components\\import\\index.vue","mtime":1706609443769},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706623133642},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706623133548},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\postcss-loader\\src\\index.js","mtime":1706623132990},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1706623138425},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js","mtime":1706623133543}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoubm0tY29kZS1nZW5lcmF0b3ItbW9kZWwtcHJvcGVydHktaW1wb3J0IHsNCiAgcGFkZGluZzogMTBweDsNCiAgaGVpZ2h0OiAxMDAlOw0KICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAuZWwtdHJhbnNmZXItcGFuZWwgew0KICAgIHdpZHRoOiAzMDBweDsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgLmVsLXRyYW5zZmVyLXBhbmVsX19ib2R5IHsNCiAgICAgIGhlaWdodDogNDU1cHg7DQogICAgICAuZWwtdHJhbnNmZXItcGFuZWxfX2xpc3Qgew0KICAgICAgICBoZWlnaHQ6IDEwMCU7DQogICAgICB9DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA2GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/modelProperty/components/import","sourcesContent":["<template>\r\n  <nm-dialog v-bind=\"dialog\" :visible.sync=\"visible_\" @open=\"onOpen\">\r\n    <el-transfer class=\"nm-code-generator-model-property-import\" v-model=\"value\" :data=\"list\"></el-transfer>\r\n    <template v-slot:footer>\r\n      <nm-button type=\"success\" text=\"保存\" @click=\"submit\" />\r\n    </template>\r\n  </nm-dialog>\r\n</template>\r\n<script>\r\nimport { mixins } from 'netmodular-ui'\r\n\r\nconst api = $api.codeGenerator.modelProperty\r\nconst propertyApi = $api.codeGenerator.property\r\n\r\nexport default {\r\n  mixins: [mixins.visible],\r\n  data() {\r\n    return {\r\n      list: [],\r\n      value: [],\r\n      loading: false\r\n    }\r\n  },\r\n  props: {\r\n    total: Number,\r\n    parent: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    modelType: {\r\n      type: Number,\r\n      required: true\r\n    }\r\n  },\r\n  computed: {\r\n    dialog() {\r\n      return {\r\n        title: `从实体中导入属性(${this.parent.name})`,\r\n        icon: 'import',\r\n        width: '803px',\r\n        height: '600px',\r\n        noScrollbar: true,\r\n        loading: this.loading,\r\n        footer: true\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    queryList() {\r\n      this.list = []\r\n      propertyApi.select(this.parent.id).then(data => {\r\n        data.map(m => {\r\n          if (m.value !== 'Id') {\r\n            this.list.push({\r\n              key: m.value,\r\n              label: m.label,\r\n              disabled: this.value.includes(m.value),\r\n              data: m.data\r\n            })\r\n          }\r\n        })\r\n      })\r\n    },\r\n    querySelected() {\r\n      this.value = []\r\n      api.select({ classId: this.parent.id, modelType: this.modelType }).then(data => {\r\n        data.map(m => {\r\n          this.value.push(m.value)\r\n        })\r\n        this.queryList()\r\n      })\r\n    },\r\n    submit() {\r\n      let ids = []\r\n      this.list.map(m => {\r\n        if (this.value.includes(m.key) && !m.disabled) {\r\n          ids.push(m.data)\r\n        }\r\n      })\r\n\r\n      if (ids.length < 1) {\r\n        this._warning('请选择属性')\r\n        return\r\n      }\r\n\r\n      const params = { classId: this.parent.id, modelType: this.modelType, ids, sort: this.total }\r\n      this.loading = true\r\n      api\r\n        .importFromEntity(params)\r\n        .then(() => {\r\n          this._success('保存成功')\r\n          this.$emit('success')\r\n          this.loading = false\r\n          this.visible_ = false\r\n        })\r\n        .catch(() => {\r\n          this._error('保存失败')\r\n          this.loading = false\r\n        })\r\n    },\r\n    onOpen() {\r\n      this.querySelected()\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n.nm-code-generator-model-property-import {\r\n  padding: 10px;\r\n  height: 100%;\r\n  box-sizing: border-box;\r\n  .el-transfer-panel {\r\n    width: 300px;\r\n    height: 100%;\r\n    .el-transfer-panel__body {\r\n      height: 455px;\r\n      .el-transfer-panel__list {\r\n        height: 100%;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}