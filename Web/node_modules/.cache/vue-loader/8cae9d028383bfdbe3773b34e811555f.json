{"remainingRequest":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-ui\\packages\\components\\login-default\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\netmodular-ui\\packages\\components\\login-default\\index.vue","mtime":1706623144444},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\babel-loader\\lib\\index.js","mtime":1706623138119},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js","mtime":1706623133543}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBtYXBTdGF0ZSwgbWFwR2V0dGVycywgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdMb2dpbkRlZmF1bHQnLA0KICBkYXRhKCkgew0KICAgIGNvbnN0IF90aGlzID0gdGhpcw0KICAgIHJldHVybiB7DQogICAgICB2ZXJpZnlDb2RlVXJsOiAnJywNCiAgICAgIGZvcm06IHsNCiAgICAgICAgdXNlck5hbWU6ICcnLA0KICAgICAgICBwYXNzd29yZDogJycsDQogICAgICAgIGFjY291bnRUeXBlOiAwLA0KICAgICAgICB2ZXJpZnlDb2RlOiB7DQogICAgICAgICAgaWQ6ICcnLA0KICAgICAgICAgIGNvZGU6ICcnDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICBydWxlczogew0KICAgICAgICB1c2VyTmFtZTogWw0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeeUqOaIt+WQjScsDQogICAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicNCiAgICAgICAgICB9DQogICAgICAgIF0sDQogICAgICAgIHBhc3N3b3JkOiBbDQogICAgICAgICAgew0KICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5a+G56CBJywNCiAgICAgICAgICAgIHRyaWdnZXI6ICdibHVyJw0KICAgICAgICAgIH0NCiAgICAgICAgXSwNCiAgICAgICAgY29kZTogWw0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHZhbGlkYXRvcihydWxlLCB2YWx1ZSwgY2FsbGJhY2spIHsNCiAgICAgICAgICAgICAgaWYgKF90aGlzLmxvZ2luVmVyaWZ5Q29kZSAmJiB2YWx1ZSA9PT0gJycpIHsNCiAgICAgICAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+ivt+i+k+WFpemqjOivgeeggScpKQ0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGNhbGxiYWNrKCkNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRyaWdnZXI6ICdibHVyJw0KICAgICAgICAgIH0NCiAgICAgICAgXQ0KICAgICAgfSwNCiAgICAgIGxvYWRpbmc6IGZhbHNlDQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcEdldHRlcnMoJ2FwcC9jb25maWcnLCBbJ2xvZ29VcmwnXSksDQogICAgLi4ubWFwU3RhdGUoJ2FwcC9jb25maWcnLCB7DQogICAgICB0aXRsZTogcyA9PiBzLnN5c3RlbS50aXRsZSwNCiAgICAgIGNvcHlyaWdodDogcyA9PiBzLnN5c3RlbS5jb3B5cmlnaHQsDQogICAgICBsb2dpbk9wdGlvbnM6IHMgPT4gcy5jb21wb25lbnQubG9naW4NCiAgICB9KSwNCiAgICAuLi5tYXBTdGF0ZSgnYXBwL3N5c3RlbScsIHsNCiAgICAgIGdldFZlcmlmeUNvZGU6IHMgPT4gcy5hY3Rpb25zLmdldFZlcmlmeUNvZGUNCiAgICB9KQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIGlmICh0aGlzLmxvZ2luT3B0aW9ucy52ZXJpZnlDb2RlKSB7DQogICAgICB0aGlzLnJlZnJlc2hWaWVyaWZ5Q29kZSgpDQogICAgfQ0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlID0+IHsNCiAgICAgIGlmIChlLmtleUNvZGUgPT09IDEzKSB7DQogICAgICAgIHRoaXMudHJ5TG9naW4oKQ0KICAgICAgfQ0KICAgIH0pDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAuLi5tYXBBY3Rpb25zKCdhcHAvc3lzdGVtJywgWydsb2dpbiddKSwNCiAgICAvLyDliLfmlrDpqozor4HnoIENCiAgICBhc3luYyByZWZyZXNoVmllcmlmeUNvZGUoKSB7DQogICAgICBsZXQgZGF0YSA9IGF3YWl0IHRoaXMuZ2V0VmVyaWZ5Q29kZSgpDQogICAgICB0aGlzLnZlcmlmeUNvZGVVcmwgPSBkYXRhLmJhc2U2NFN0cmluZw0KICAgICAgdGhpcy5mb3JtLnZlcmlmeUNvZGUuaWQgPSBkYXRhLmlkDQogICAgfSwNCiAgICAvLyDnmbvlvZUNCiAgICB0cnlMb2dpbigpIHsNCiAgICAgIHRoaXMuJHJlZnMuZm9ybS52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7DQogICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWUNCg0KICAgICAgICAgIHRoaXMubG9naW4odGhpcy5mb3JtKQ0KICAgICAgICAgICAgLnRoZW4oZGF0YSA9PiB7DQogICAgICAgICAgICAgIC8vIOWIneWni+WMluS7pOeJjA0KICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2FwcC90b2tlbi9pbml0JywgZGF0YSkNCg0KICAgICAgICAgICAgICAvLyDot7PovawNCiAgICAgICAgICAgICAgbGV0IHJlZGlyZWN0ID0gdGhpcy4kcm91dGUucXVlcnkucmVkaXJlY3QNCiAgICAgICAgICAgICAgaWYgKCFyZWRpcmVjdCB8fCByZWRpcmVjdCA9PT0gJycpIHsNCiAgICAgICAgICAgICAgICByZWRpcmVjdCA9ICcvJw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goew0KICAgICAgICAgICAgICAgIHBhdGg6IHJlZGlyZWN0DQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4gew0KICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9DQogIH0sDQogIHdhdGNoOiB7DQogICAgbG9naW5PcHRpb25zOiB7DQogICAgICBpbW1lZGlhdGU6IHRydWUsDQogICAgICBoYW5kbGVyKHZhbCkgew0KICAgICAgICB0aGlzLmZvcm0uYWNjb3VudFR5cGUgPSB2YWwuZGVmYXVsdEFjY291bnRUeXBlDQogICAgICB9DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAwDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/netmodular-ui/packages/components/login-default","sourcesContent":["<template>\r\n  <div class=\"nm-login-default\">\r\n    <div class=\"nm-login-bg\" />\r\n    <div class=\"nm-login-box\">\r\n      <div class=\"nm-login-content\">\r\n        <div class=\"nm-login-logo\">\r\n          <img class=\"nm-login-logo-img\" :src=\"logoUrl\" />\r\n          <h1 class=\"nm-login-logo-title\">{{ title }}</h1>\r\n        </div>\r\n        <el-form ref=\"form\" :model=\"form\" :rules=\"rules\">\r\n          <el-form-item v-if=\"loginOptions.accountTypes\" prop=\"accountType\">\r\n            <el-select v-model=\"form.accountType\" placeholder=\"账户类型\">\r\n              <template v-slot:prefix>\r\n                <nm-icon name=\"project\" />\r\n              </template>\r\n              <el-option v-for=\"item in loginOptions.accountTypes\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item prop=\"userName\">\r\n            <el-input v-model=\"form.userName\" placeholder=\"用户名\">\r\n              <template v-slot:prefix>\r\n                <nm-icon name=\"user\" />\r\n              </template>\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"password\">\r\n            <el-input type=\"password\" v-model=\"form.password\" autocomplete=\"off\" placeholder=\"密码\">\r\n              <template v-slot:prefix>\r\n                <nm-icon name=\"password\" />\r\n              </template>\r\n            </el-input>\r\n          </el-form-item>\r\n          <div v-if=\"loginOptions.verifyCode\" class=\"verifycode\">\r\n            <div class=\"verifycode-input\">\r\n              <el-form-item prop=\"verifyCode.code\">\r\n                <el-input v-model=\"form.verifyCode.code\" autocomplete=\"off\" placeholder=\"验证码\">\r\n                  <template v-slot:prefix>\r\n                    <nm-icon name=\"verifycode\"></nm-icon>\r\n                  </template>\r\n                </el-input>\r\n              </el-form-item>\r\n            </div>\r\n            <div class=\"verifycode-img\">\r\n              <img title=\"点击刷新\" :src=\"verifyCodeUrl\" @click=\"refreshVierifyCode\" />\r\n            </div>\r\n          </div>\r\n          <el-form-item style=\"text-align:right;\">\r\n            <el-button :loading=\"loading\" class=\"btn-login\" type=\"primary\" @click=\"tryLogin\">登录</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    </div>\r\n    <div class=\"copyright\">{{ copyright }}</div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapState, mapGetters, mapActions } from 'vuex'\r\nexport default {\r\n  name: 'LoginDefault',\r\n  data() {\r\n    const _this = this\r\n    return {\r\n      verifyCodeUrl: '',\r\n      form: {\r\n        userName: '',\r\n        password: '',\r\n        accountType: 0,\r\n        verifyCode: {\r\n          id: '',\r\n          code: ''\r\n        }\r\n      },\r\n      rules: {\r\n        userName: [\r\n          {\r\n            required: true,\r\n            message: '请输入用户名',\r\n            trigger: 'blur'\r\n          }\r\n        ],\r\n        password: [\r\n          {\r\n            required: true,\r\n            message: '请输入密码',\r\n            trigger: 'blur'\r\n          }\r\n        ],\r\n        code: [\r\n          {\r\n            validator(rule, value, callback) {\r\n              if (_this.loginVerifyCode && value === '') {\r\n                callback(new Error('请输入验证码'))\r\n              } else {\r\n                callback()\r\n              }\r\n            },\r\n            trigger: 'blur'\r\n          }\r\n        ]\r\n      },\r\n      loading: false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters('app/config', ['logoUrl']),\r\n    ...mapState('app/config', {\r\n      title: s => s.system.title,\r\n      copyright: s => s.system.copyright,\r\n      loginOptions: s => s.component.login\r\n    }),\r\n    ...mapState('app/system', {\r\n      getVerifyCode: s => s.actions.getVerifyCode\r\n    })\r\n  },\r\n  mounted() {\r\n    if (this.loginOptions.verifyCode) {\r\n      this.refreshVierifyCode()\r\n    }\r\n    document.addEventListener('keydown', e => {\r\n      if (e.keyCode === 13) {\r\n        this.tryLogin()\r\n      }\r\n    })\r\n  },\r\n  methods: {\r\n    ...mapActions('app/system', ['login']),\r\n    // 刷新验证码\r\n    async refreshVierifyCode() {\r\n      let data = await this.getVerifyCode()\r\n      this.verifyCodeUrl = data.base64String\r\n      this.form.verifyCode.id = data.id\r\n    },\r\n    // 登录\r\n    tryLogin() {\r\n      this.$refs.form.validate(async valid => {\r\n        if (valid) {\r\n          this.loading = true\r\n\r\n          this.login(this.form)\r\n            .then(data => {\r\n              // 初始化令牌\r\n              this.$store.commit('app/token/init', data)\r\n\r\n              // 跳转\r\n              let redirect = this.$route.query.redirect\r\n              if (!redirect || redirect === '') {\r\n                redirect = '/'\r\n              }\r\n\r\n              this.$router.push({\r\n                path: redirect\r\n              })\r\n            })\r\n            .finally(() => {\r\n              this.loading = false\r\n            })\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  },\r\n  watch: {\r\n    loginOptions: {\r\n      immediate: true,\r\n      handler(val) {\r\n        this.form.accountType = val.defaultAccountType\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n.nm-login-default > .nm-login-bg {\r\n  background-image: url('../../../public/images/login/bg3.jpg');\r\n}\r\n</style>\r\n"]}]}