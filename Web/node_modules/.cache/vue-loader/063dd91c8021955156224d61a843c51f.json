{"remainingRequest":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\src\\views\\modelProperty\\components\\import\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\src\\views\\modelProperty\\components\\import\\index.vue","mtime":1706609443769},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\babel-loader\\lib\\index.js","mtime":1706623138119},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706623138253},{"path":"E:\\NetModular.CodeGenerator\\src\\UI\\module-codegenerator\\node_modules\\vue-loader\\lib\\index.js","mtime":1706623133543}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBtaXhpbnMgfSBmcm9tICduZXRtb2R1bGFyLXVpJw0KDQpjb25zdCBhcGkgPSAkYXBpLmNvZGVHZW5lcmF0b3IubW9kZWxQcm9wZXJ0eQ0KY29uc3QgcHJvcGVydHlBcGkgPSAkYXBpLmNvZGVHZW5lcmF0b3IucHJvcGVydHkNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBtaXhpbnM6IFttaXhpbnMudmlzaWJsZV0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGxpc3Q6IFtdLA0KICAgICAgdmFsdWU6IFtdLA0KICAgICAgbG9hZGluZzogZmFsc2UNCiAgICB9DQogIH0sDQogIHByb3BzOiB7DQogICAgdG90YWw6IE51bWJlciwNCiAgICBwYXJlbnQ6IHsNCiAgICAgIHR5cGU6IE9iamVjdCwNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfSwNCiAgICBtb2RlbFR5cGU6IHsNCiAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIGRpYWxvZygpIHsNCiAgICAgIHJldHVybiB7DQogICAgICAgIHRpdGxlOiBg5LuO5a6e5L2T5Lit5a+85YWl5bGe5oCnKCR7dGhpcy5wYXJlbnQubmFtZX0pYCwNCiAgICAgICAgaWNvbjogJ2ltcG9ydCcsDQogICAgICAgIHdpZHRoOiAnODAzcHgnLA0KICAgICAgICBoZWlnaHQ6ICc2MDBweCcsDQogICAgICAgIG5vU2Nyb2xsYmFyOiB0cnVlLA0KICAgICAgICBsb2FkaW5nOiB0aGlzLmxvYWRpbmcsDQogICAgICAgIGZvb3RlcjogdHJ1ZQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHF1ZXJ5TGlzdCgpIHsNCiAgICAgIHRoaXMubGlzdCA9IFtdDQogICAgICBwcm9wZXJ0eUFwaS5zZWxlY3QodGhpcy5wYXJlbnQuaWQpLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIGRhdGEubWFwKG0gPT4gew0KICAgICAgICAgIGlmIChtLnZhbHVlICE9PSAnSWQnKSB7DQogICAgICAgICAgICB0aGlzLmxpc3QucHVzaCh7DQogICAgICAgICAgICAgIGtleTogbS52YWx1ZSwNCiAgICAgICAgICAgICAgbGFiZWw6IG0ubGFiZWwsDQogICAgICAgICAgICAgIGRpc2FibGVkOiB0aGlzLnZhbHVlLmluY2x1ZGVzKG0udmFsdWUpLA0KICAgICAgICAgICAgICBkYXRhOiBtLmRhdGENCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHF1ZXJ5U2VsZWN0ZWQoKSB7DQogICAgICB0aGlzLnZhbHVlID0gW10NCiAgICAgIGFwaS5zZWxlY3QoeyBjbGFzc0lkOiB0aGlzLnBhcmVudC5pZCwgbW9kZWxUeXBlOiB0aGlzLm1vZGVsVHlwZSB9KS50aGVuKGRhdGEgPT4gew0KICAgICAgICBkYXRhLm1hcChtID0+IHsNCiAgICAgICAgICB0aGlzLnZhbHVlLnB1c2gobS52YWx1ZSkNCiAgICAgICAgfSkNCiAgICAgICAgdGhpcy5xdWVyeUxpc3QoKQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHN1Ym1pdCgpIHsNCiAgICAgIGxldCBpZHMgPSBbXQ0KICAgICAgdGhpcy5saXN0Lm1hcChtID0+IHsNCiAgICAgICAgaWYgKHRoaXMudmFsdWUuaW5jbHVkZXMobS5rZXkpICYmICFtLmRpc2FibGVkKSB7DQogICAgICAgICAgaWRzLnB1c2gobS5kYXRhKQ0KICAgICAgICB9DQogICAgICB9KQ0KDQogICAgICBpZiAoaWRzLmxlbmd0aCA8IDEpIHsNCiAgICAgICAgdGhpcy5fd2FybmluZygn6K+36YCJ5oup5bGe5oCnJykNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQoNCiAgICAgIGNvbnN0IHBhcmFtcyA9IHsgY2xhc3NJZDogdGhpcy5wYXJlbnQuaWQsIG1vZGVsVHlwZTogdGhpcy5tb2RlbFR5cGUsIGlkcywgc29ydDogdGhpcy50b3RhbCB9DQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlDQogICAgICBhcGkNCiAgICAgICAgLmltcG9ydEZyb21FbnRpdHkocGFyYW1zKQ0KICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgdGhpcy5fc3VjY2Vzcygn5L+d5a2Y5oiQ5YqfJykNCiAgICAgICAgICB0aGlzLiRlbWl0KCdzdWNjZXNzJykNCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICAgIHRoaXMudmlzaWJsZV8gPSBmYWxzZQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKCkgPT4gew0KICAgICAgICAgIHRoaXMuX2Vycm9yKCfkv53lrZjlpLHotKUnKQ0KICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlDQogICAgICAgIH0pDQogICAgfSwNCiAgICBvbk9wZW4oKSB7DQogICAgICB0aGlzLnF1ZXJ5U2VsZWN0ZWQoKQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AASA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/modelProperty/components/import","sourcesContent":["<template>\r\n  <nm-dialog v-bind=\"dialog\" :visible.sync=\"visible_\" @open=\"onOpen\">\r\n    <el-transfer class=\"nm-code-generator-model-property-import\" v-model=\"value\" :data=\"list\"></el-transfer>\r\n    <template v-slot:footer>\r\n      <nm-button type=\"success\" text=\"保存\" @click=\"submit\" />\r\n    </template>\r\n  </nm-dialog>\r\n</template>\r\n<script>\r\nimport { mixins } from 'netmodular-ui'\r\n\r\nconst api = $api.codeGenerator.modelProperty\r\nconst propertyApi = $api.codeGenerator.property\r\n\r\nexport default {\r\n  mixins: [mixins.visible],\r\n  data() {\r\n    return {\r\n      list: [],\r\n      value: [],\r\n      loading: false\r\n    }\r\n  },\r\n  props: {\r\n    total: Number,\r\n    parent: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    modelType: {\r\n      type: Number,\r\n      required: true\r\n    }\r\n  },\r\n  computed: {\r\n    dialog() {\r\n      return {\r\n        title: `从实体中导入属性(${this.parent.name})`,\r\n        icon: 'import',\r\n        width: '803px',\r\n        height: '600px',\r\n        noScrollbar: true,\r\n        loading: this.loading,\r\n        footer: true\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    queryList() {\r\n      this.list = []\r\n      propertyApi.select(this.parent.id).then(data => {\r\n        data.map(m => {\r\n          if (m.value !== 'Id') {\r\n            this.list.push({\r\n              key: m.value,\r\n              label: m.label,\r\n              disabled: this.value.includes(m.value),\r\n              data: m.data\r\n            })\r\n          }\r\n        })\r\n      })\r\n    },\r\n    querySelected() {\r\n      this.value = []\r\n      api.select({ classId: this.parent.id, modelType: this.modelType }).then(data => {\r\n        data.map(m => {\r\n          this.value.push(m.value)\r\n        })\r\n        this.queryList()\r\n      })\r\n    },\r\n    submit() {\r\n      let ids = []\r\n      this.list.map(m => {\r\n        if (this.value.includes(m.key) && !m.disabled) {\r\n          ids.push(m.data)\r\n        }\r\n      })\r\n\r\n      if (ids.length < 1) {\r\n        this._warning('请选择属性')\r\n        return\r\n      }\r\n\r\n      const params = { classId: this.parent.id, modelType: this.modelType, ids, sort: this.total }\r\n      this.loading = true\r\n      api\r\n        .importFromEntity(params)\r\n        .then(() => {\r\n          this._success('保存成功')\r\n          this.$emit('success')\r\n          this.loading = false\r\n          this.visible_ = false\r\n        })\r\n        .catch(() => {\r\n          this._error('保存失败')\r\n          this.loading = false\r\n        })\r\n    },\r\n    onOpen() {\r\n      this.querySelected()\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n.nm-code-generator-model-property-import {\r\n  padding: 10px;\r\n  height: 100%;\r\n  box-sizing: border-box;\r\n  .el-transfer-panel {\r\n    width: 300px;\r\n    height: 100%;\r\n    .el-transfer-panel__body {\r\n      height: 455px;\r\n      .el-transfer-panel__list {\r\n        height: 100%;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}